---
import { getCollection, render } from 'astro:content';
import Layout from '../../layouts/Layout.astro';

export async function getStaticPaths() {
  const posts = await getCollection('blog');
  return posts.map((post) => ({
    params: { slug: post.id },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await render(post);
const isFuture = post.data.date > new Date();

function formatDate(date: Date) {
  return date.toLocaleDateString('en-GB', { year: 'numeric', month: 'long', day: 'numeric' });
}
---

<Layout title={`${post.data.title} ‚Äî JD Fortress AI`} description={post.data.excerpt} noindex={isFuture}>

  {isFuture && (
    <div style="background:#fef3c7; border-bottom:1px solid #f59e0b; padding:10px 24px; text-align:center;">
      <span style="color:#92400e; font-size:0.85rem; font-weight:600;">üêõ Debug preview ‚Äî this post is scheduled for {formatDate(post.data.date)} and is not yet publicly visible.</span>
    </div>
  )}

  <!-- HERO -->
  <section style="background:#0F2041; padding:80px 24px 64px;">
    <div style="max-width:760px; margin:0 auto;">
      <a href="/blog" style="color:rgba(255,255,255,0.5); text-decoration:none; font-size:0.9rem; display:inline-flex; align-items:center; gap:6px; margin-bottom:28px;" onmouseover="this.style.color='#fff'" onmouseout="this.style.color='rgba(255,255,255,0.5)'">
        ‚Üê Blog
      </a>
      <h1 style="color:#fff; font-size:clamp(1.8rem, 4vw, 2.8rem); font-weight:700; line-height:1.15; letter-spacing:-0.02em; margin:0 0 20px;">
        {post.data.title}
      </h1>
      <div style="display:flex; align-items:center; gap:16px; flex-wrap:wrap;">
        <span style="color:rgba(255,255,255,0.5); font-size:0.9rem;">{formatDate(post.data.date)}</span>
        <span style="color:rgba(255,255,255,0.2);">¬∑</span>
        <span style="color:rgba(255,255,255,0.5); font-size:0.9rem;">{post.data.author}</span>
      </div>
    </div>
  </section>

  <!-- CONTENT -->
  <section style="background:#fff; padding:64px 24px 96px;">
    <div style="max-width:720px; margin:0 auto;">
      <p style="color:#56585E; font-size:1.05rem; line-height:1.8; font-style:italic; border-left:3px solid #1E6FF5; padding-left:20px; margin:0 0 40px;">
        {post.data.excerpt}
      </p>
      <div class="prose">
        <Content />
      </div>
    </div>
  </section>

  <!-- CTA -->
  <section style="background:#F0F4FF; padding:64px 24px; text-align:center;">
    <div style="max-width:560px; margin:0 auto;">
      <h2 style="color:#0D141A; font-size:1.5rem; font-weight:700; margin:0 0 12px;">Enjoyed this article?</h2>
      <p style="color:#56585E; font-size:0.95rem; margin:0 0 28px; line-height:1.7;">If you're thinking about secure AI for your business, we'd love to have a conversation.</p>
      <a href="/contact" style="background:#1E6FF5; color:#fff; padding:12px 28px; border-radius:8px; text-decoration:none; font-weight:600; font-size:0.95rem;" onmouseover="this.style.background='#1558cc'" onmouseout="this.style.background='#1E6FF5'">
        Get in Touch ‚Üí
      </a>
    </div>
  </section>

</Layout>

<style is:global>
  .prose {
    color: #0D141A;
    font-size: 1.05rem;
    line-height: 1.85;
  }

  /* Headings */
  .prose h2 {
    font-size: 1.55rem;
    font-weight: 700;
    line-height: 1.25;
    letter-spacing: -0.02em;
    color: #0D141A;
    margin-top: 3rem;
    margin-bottom: 1.1rem;
  }
  .prose h3 {
    font-size: 1.2rem;
    font-weight: 700;
    line-height: 1.35;
    color: #0D141A;
    margin-top: 2.25rem;
    margin-bottom: 0.75rem;
  }
  .prose h4 {
    font-size: 1rem;
    font-weight: 700;
    color: #0D141A;
    margin-top: 2rem;
    margin-bottom: 0.5rem;
  }

  /* Paragraphs ‚Äî generous vertical rhythm */
  .prose p {
    color: #374151;
    margin-top: 0;
    margin-bottom: 1.75rem;
  }
  .prose p:last-child {
    margin-bottom: 0;
  }

  /* Lists */
  .prose ul,
  .prose ol {
    color: #374151;
    padding-left: 1.6rem;
    margin-top: 0;
    margin-bottom: 1.75rem;
  }
  .prose ul { list-style-type: disc; }
  .prose ol { list-style-type: decimal; }
  .prose li {
    margin-bottom: 0.6rem;
    line-height: 1.75;
  }
  .prose li > p {
    margin-bottom: 0.5rem;
  }

  /* Inline */
  .prose strong {
    font-weight: 700;
    color: #0D141A;
  }
  .prose em {
    font-style: italic;
  }
  .prose a {
    color: #1E6FF5;
    text-decoration: underline;
    text-underline-offset: 2px;
  }
  .prose a:hover {
    color: #1558cc;
  }

  /* Horizontal rule */
  .prose hr {
    border: none;
    border-top: 1px solid #e0e8f5;
    margin: 3rem 0;
  }

  /* Blockquote */
  .prose blockquote {
    border-left: 3px solid #1E6FF5;
    margin: 2rem 0;
    padding: 0.75rem 0 0.75rem 1.5rem;
    color: #56585E;
    font-style: italic;
  }
  .prose blockquote p {
    margin-bottom: 0;
  }

  /* Code */
  .prose code {
    background: #F0F4FF;
    padding: 0.15em 0.4em;
    border-radius: 4px;
    font-size: 0.88em;
    font-family: ui-monospace, 'Cascadia Code', monospace;
  }
  .prose pre {
    background: #0D141A;
    color: #e2e8f0;
    padding: 1.25rem 1.5rem;
    border-radius: 8px;
    overflow-x: auto;
    margin-bottom: 1.75rem;
  }
  .prose pre code {
    background: none;
    padding: 0;
    font-size: 0.9em;
  }
</style>
